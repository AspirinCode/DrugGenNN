# DrugGenNN

DrugGenNN - алгоритм для генерирования новых лечебных малых молекул.

## Мотивация 

Сейчас процесс разработки новых лекарств дорог и не всегда эффективен. Он заключается в синтезе большого числа молекул, которые совсем не обязательно будут реагировать с целевыми белками. Существуют алгоритмы, которые находят в базе известных молекул те, которые могут подойти для нашей задачи, однако и здесь вероятность не стопроцентная. После нахождения таких “возможных” решений химики начинают вносить в их структуру небольшие изменения, в надежде повысить эффективность реакции. Понятно, что такие решения ограничены размерами базы молекул, да и процесс последующих улучшений крайне долгий и ресурсозатратный, поэтому хотелось бы получить метод, который бы сразу генерировал наиболее подходящие структуры. 

## Решение

В цифровом виде молекулы хранятся в формате SMILES - фактически, это просто буквенные последовательности. Однако, кроме этих строк структуру молекул определяет ряд других параметров, которые тоже нужно учесть при генерации. Итоговым решением стала рекуррентная символьная модель, которая создаёт новые последовательности с условием заданных параметров. 

Процесс обучения модели аналогичен обучению модели для генерирования текста - мы кормим ей последовательности, и она учится предсказывать следующий символ при условии предыдущих. Но и здесь всё не так просто.

Нам необходимо генерировать молекулы для связи с конкретными рецепторами, поэтому и обучать модель нужно на соответствующей выборке. Однако, число известных реагирующих молекул обычно крайне невелико (около 1-5 тыс.) и обучать на них RNN-ку невозможно в связи  с быстрым оверфитом. Для борьбы с этим пришлось прибегнуть к transfer learning’у - сначала мы учимся генерировать абстрактные молекулы, а потом уже дообучаемся на целевой выборке. 


## Результат

Итоговая модель генерирует 60-65% процентов валидных смайлов до и после дообучения. 

Минимумы кривых неявных вероятностей, которые нейронка расставляет смайлам при условии аффинности приближаются к настоящим значениям аффинности, что говорит о неплохом понимании особенностей молекул, реагирующих с рецептором.

Были также попытки провалидировать метод с помощью докинга, но столкнулись с проблемой интерпретирования его результатов. 

## Дальнейший план

В дальнейшем планируется продолжить работать над задачей под немного другим углом - сфокусироваться на векторизации структур молекул и их восстановления из скрытого представления (пример: AutoEncoder). 

Это позволит использовать методы градиентной оптимизации по значениям аффинности с рецепторами, что может привести к неплохим результатам. 

## Ссылки

* [Google перзентация](https://docs.google.com/presentation/d/1Dh5_amSvJR179avgK0QwkqI-6yY9wVCaJgFZld4tgQM/edit?usp=sharing)
* Проект поддерживается на [гитхабе](https://github.com/TheRussianFella/DrugGenNN.git), так что если вам интересна его дальнейшая судьба - милости просим.